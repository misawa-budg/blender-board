<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Blender Board | 詳細</title>
    <link rel="stylesheet" href="/styles/board.css" />
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  </head>
  <body>
    <div class="page">
      <header class="hero">
        <p class="eyebrow">Blender Board</p>
        <h1 id="detail-heading">詳細</h1>
        <p id="detail-description" class="description"></p>
      </header>

      <main>
        <nav class="tabs" aria-label="ギャラリータブ">
          <a id="tab-images" class="tab-link" href="/images">画像</a>
          <a id="tab-models" class="tab-link" href="/models">モデル</a>
        </nav>

        <section class="detail-panel">
          <div id="detail-status" class="status hidden" aria-live="polite"></div>
          <div id="action-status" class="status hidden" aria-live="polite"></div>

          <article id="detail-card" class="detail-card hidden">
            <h2 id="item-title" class="detail-title"></h2>
            <div id="detail-preview" class="detail-preview hidden">
              <img id="detail-preview-image" class="detail-preview-image" src="" alt="画像プレビュー" />
              <model-viewer
                id="detail-preview-model"
                class="detail-preview-model hidden"
                src=""
                camera-controls
                auto-rotate
                interaction-prompt="none"
                loading="lazy"
              ></model-viewer>
              <p id="detail-preview-note" class="detail-preview-note hidden"></p>
            </div>
            <dl class="detail-grid">
              <dt>ID</dt>
              <dd id="item-id"></dd>
              <dt>投稿者</dt>
              <dd id="item-author"></dd>
              <dt>作成日時</dt>
              <dd id="item-created"></dd>
              <dt>元ファイル名</dt>
              <dd id="item-original-name"></dd>
              <dt>MIMEタイプ</dt>
              <dd id="item-mime-type"></dd>
              <dt>ファイルサイズ</dt>
              <dd id="item-file-size"></dd>
            </dl>

            <section id="related-models-section" class="related-section hidden">
              <h3>この画像で使われたモデル</h3>
              <ul id="related-models-list" class="related-list"></ul>
            </section>

            <section id="related-images-section" class="related-section hidden">
              <h3>このモデルが使われた画像</h3>
              <ul id="related-images-list" class="related-list"></ul>
            </section>

            <div class="detail-actions">
              <a id="download-link" class="download-link" href="#">ダウンロード</a>
              <a id="back-link" class="tab-link" href="/images">一覧へ戻る</a>
            </div>

            <section class="detail-edit">
              <h3>編集</h3>
              <form id="edit-form" class="upload-form" enctype="multipart/form-data">
                <div class="form-grid">
                  <label class="field">
                    <span>タイトル</span>
                    <input id="edit-title" name="title" type="text" maxlength="120" required />
                  </label>
                  <label class="field">
                    <span>投稿者</span>
                    <input id="edit-author" name="author" type="text" maxlength="120" required />
                  </label>
                  <label id="edit-model-ids-field" class="field hidden">
                    <span>関連モデルID（任意 / カンマ区切り）</span>
                    <input id="edit-model-ids" name="modelIds" type="text" placeholder="例: 12,15,21" />
                  </label>
                  <label class="field field-file">
                    <span>ファイル差し替え（任意）</span>
                    <input id="edit-file" name="file" type="file" />
                  </label>
                  <label id="edit-preview-file-field" class="field field-file hidden">
                    <span>プレビュー用3D差し替え（任意 / glb,gltf）</span>
                    <input id="edit-preview-file" name="previewFile" type="file" accept=".glb,.gltf" />
                  </label>
                </div>
                <div class="detail-edit-actions">
                  <button id="save-button" type="submit">保存</button>
                  <button id="delete-button" class="danger-button" type="button">削除</button>
                </div>
              </form>
            </section>
          </article>
        </section>
      </main>
    </div>

    <div id="delete-confirm-overlay" class="confirm-overlay hidden" role="dialog" aria-modal="true">
      <div class="confirm-card">
        <h2 class="confirm-title">投稿の削除</h2>
        <p id="delete-confirm-message" class="confirm-message"></p>
        <div class="confirm-actions">
          <button id="delete-cancel-button" type="button">キャンセル</button>
          <button id="delete-confirm-button" class="danger-button" type="button">削除する</button>
        </div>
      </div>
    </div>

    <script src="/scripts/detail.js" defer></script>
  </body>
</html>
